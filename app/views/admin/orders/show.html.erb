<div class="container">
  <h3>注文履歴詳細</h3>
  <table class="table table--borderless">
    <tbody>
      <tr>
        <th><strong>購入者</strong></th>
        <td><%= @order.customer.last_name %> <%= @order.customer.first_name %></td>
      </tr>
      <tr>
        <th><strong>注文日</strong></th>
        <td><%= @order.created_at %></td>
      </tr>
      <tr>
        <th><strong>配送先</strong></th>
        <td>
          <%= @order.post_code %> <%= @order.address %><br>
          <%= @order.address_name %>
        </td>
      </tr>
      <tr>
        <th><strong>支払い方法</strong></th>
        <td><%= @order.payment_methods_i18n_invert %></td>
      </tr>
      <tr>
        <th><strong>注文ステータス</strong></th>
        <td>
          <%= form_with(model: @order, local: true) do |f| %>
            <%= f.select :status, Order.statuses_i18n_invert, {}, class:"form-control" %>
            <%= f.submit "更新", class:"btn btn-success" %>
          <% end %>
        </td>
      </tr>
    </tbody>
  </table>
  <div class="d-flex">
    <table class="table">
      <thead>
        <tr>
          <th>商品名</th>
          <th>単価（税込）</th>
          <th>数量</th>
          <th>小計</th>
          <th>製作ステータス</th>
          <th></th>
        </tr>
      </thead>
      <tbody>
        <% @order.order_details.each do |order_detail| %>
          <td><%= order_detail.product.name %></td>
          <td><%= order_detail.product.price %></td>
          <td><%= order_detail.quantity %></td>
          <td><%= order_detail.price %></td>
          <td>
            <%= form_with(model:[@order, order_detail], local: true) do |f| %>
              <%= f.select :making_status, OrderDetail.making_statuses_i18n_invert, {}, class:"form-control" %>
              <%= f.submit "更新", class:"btn btn-success"%>
            <% end %>
          </td>
        <% end %>
      </tbody>
    </table>
    <table class="table table-borderless">
      <tdody>
        <tr>
          <th>商品合計</th>
          <td align="right"><%= @order.order_details.sum(:price) %>円</td>
        </tr>
        <tr>
          <th>送料</th>
          <td align="right"><%= @order.postage %>円</td>
        </tr>
        <tr>
          <th>請求金額合計</th>
          <th align="right"><%= @order.total_price %>円</td>
        </tr>
      </tdody>
    </table>
  </div>